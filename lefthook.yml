# Lefthook Configuration
# Git hooks の自動実行設定

pre-commit:
  parallel: true
  commands:
    # github-star-notifier
    format-github-star:
      glob: "github-star-notifier/**/*.{ts,tsx,js,jsx,json,jsonc}"
      run: deno fmt {staged_files}
      stage_fixed: true

    lint-github-star:
      glob: "github-star-notifier/**/*.{ts,tsx}"
      run: deno lint {staged_files}

    type-check-github-star:
      glob: "github-star-notifier/**/*.{ts,tsx}"
      run: cd github-star-notifier && deno check main.ts

    # rss-feed-notifier
    format-rss-feed:
      glob: "rss-feed-notifier/**/*.{ts,tsx,js,jsx,json,jsonc}"
      run: deno fmt {staged_files}
      stage_fixed: true

    lint-rss-feed:
      glob: "rss-feed-notifier/**/*.{ts,tsx}"
      run: deno lint {staged_files}

    type-check-rss-feed:
      glob: "rss-feed-notifier/**/*.{ts,tsx}"
      run: cd rss-feed-notifier && deno check main.ts

pre-push:
  parallel: false
  commands:
    # github-star-notifier
    test-github-star:
      glob: "github-star-notifier/**/*.{ts,tsx}"
      run: cd github-star-notifier && deno test tests/

    final-check-github-star:
      glob: "github-star-notifier/**/*.{ts,tsx}"
      run: cd github-star-notifier && deno check main.ts

    # rss-feed-notifier
    test-rss-feed:
      glob: "rss-feed-notifier/**/*.{ts,tsx}"
      run: cd rss-feed-notifier && deno test tests/

    final-check-rss-feed:
      glob: "rss-feed-notifier/**/*.{ts,tsx}"
      run: cd rss-feed-notifier && deno check main.ts
